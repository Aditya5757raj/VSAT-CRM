<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VSAT CRM - Dashboard</title>
    <link rel="stylesheet" href="../css/dashboard.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>

<body>

    <!-- Page Transition -->
    <div class="page-transition" id="pageTransition"></div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" style="width: 250px; background-color: #f4f4f4; height: 100vh;">
            <div class="sidebar-header" style="padding: 20px; overflow: visible;">
                <div class="logo" style="display: flex; align-items: center; gap: 16px; max-width: 100%;">
                    <!-- Fully Visible Logo Image -->
                    <img src="../assets/logo1.png" alt="VSAT Logo"
                        style="height: 80px; width: 80px; object-fit: contain; border-radius: 8px; background-color: white; padding: 6px; box-shadow: 0 0 8px rgba(0,0,0,0.1); flex-shrink: 0;">

                    <div class="logo-text" style="line-height: 1.2; overflow: hidden;">
                        <h1 style="font-size: 20px; margin: 0; color: #0d47a1;">VSAT CRM</h1>
                        <p style="font-size: 13px; margin: 4px 0 0; color: #444;">Customer Dashboard</p>
                    </div>
                </div>
            </div>

            <!-- Updated Navigation Menu -->
            <nav class="sidebar-nav" style="padding: 0 20px;">
                <div class="nav-section">
                    <p class="nav-title" style="margin: 10px 0; font-weight: bold;">Main Menu</p>
                    <ul class="nav-list" style="list-style: none; padding: 0;">
                        <li>
                            <button class="nav-item active" data-section="overview">
                                <i class="fas fa-th-large"></i> Dashboard
                            </button>
                        </li>
                        <!-- Call Registration with Job History as submenu -->
                        <li class="has-submenu">
                            <button class="nav-item submenu-trigger" >
                                <i class="fas fa-phone"></i> Call Registration
                                <i class="fas fa-chevron-down submenu-toggle" style="margin-left: auto;"></i>
                            </button>
                            <ul class="submenu" style="list-style: none; padding-left: 20px;">
                                <li>
                                    <button class="nav-item" data-section="complaint">
                                        <i class="fas fa-file-alt"></i> New Complaint/Job
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="job-history">
                                        <i class="fas fa-history"></i> Job History
                                    </button>
                                </li>
                            </ul>
                        </li>
                        <!-- Service Center with submenu -->
                        <li class="has-submenu">
                            <button class="nav-item submenu-trigger" >
                                <i class="fas fa-building"></i> Service Center
                                <i class="fas fa-chevron-down submenu-toggle" style="margin-left: auto;"></i>
                            </button>
                            <ul class="submenu" style="list-style: none; padding-left: 20px;">
                                <li>
                                    <button class="nav-item" data-section="list-service-centers">
                                        <i class="fas fa-list"></i> List Service Centers
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="service-partners">
                                        <i class="fas fa-handshake"></i> Service Partners
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="job-transfer">
                                        <i class="fas fa-exchange-alt"></i> Job Transfer
                                    </button>
                                </li>
                            </ul>
                        </li>
                        <!-- Manage Engineers -->
                        <li class="has-submenu">
                            <button class="nav-item submenu-trigger" >
                                <i class="fas fa-users-cog"></i> Manage Engineers
                                <i class="fas fa-chevron-down submenu-toggle" style="margin-left: auto;"></i>
                            </button>
                            <ul class="submenu" style="list-style: none; padding-left: 20px;">
                                <li>
                                    <button class="nav-item" data-section="add-engineer">
                                        <i class="fas fa-user-plus"></i> Add Engineer

                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="engineer-list">
                                        <i class="fas fa-list"></i> Engineer List

                                    </button>
                                </li>
                            </ul>
                        </li>

                        <!-- Complaints with submenu -->
                        <li class="has-submenu">
                            <button class="nav-item submenu-trigger" >
                                <i class="fas fa-exclamation-circle"></i> Complaints
                                <i class="fas fa-chevron-down submenu-toggle" style="margin-left: auto;"></i>
                            </button>
                            <ul class="submenu" style="list-style: none; padding-left: 20px;">
                                <li>
                                    <button class="nav-item" data-section="unassigned-complaints">
                                        <i class="fas fa-inbox"></i> Unassigned
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="pending-complaints">
                                        <i class="fas fa-clock"></i> Pending
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="assigned-complaints">
                                        <i class="fas fa-user-check"></i> Assigned
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="complete-complaints">
                                        <i class="fas fa-check-circle"></i> Complete
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="cancelled-complaints">
                                        <i class="fas fa-times-circle"></i> Cancelled
                                    </button>
                                </li>
                            </ul>
                        </li>

                        <!-- Engineer Section with submenu -->
                        <li class="has-submenu">
                            <button class="nav-item submenu-trigger" >
                                <i class="fas fa-hard-hat"></i> Engineer
                                <i class="fas fa-chevron-down submenu-toggle" style="margin-left: auto;"></i>
                            </button>
                            <ul class="submenu" style="list-style: none; padding-left: 20px;">
                                <li>
                                    <button class="nav-item" data-section="current-assignment">
                                        <i class="fas fa-tasks"></i> Assigned Jobs
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="update-status">
                                        <i class="fas fa-edit"></i> Update Status
                                    </button>
                                </li>
                                <li>
                                    <button class="nav-item" data-section="request-parts">
                                        <i class="fas fa-tools"></i> Request Parts
                                    </button>
                                </li>
                            </ul>
                        </li>

                        <!-- Delivery Challan -->
                        <li>
                            <button class="nav-item" data-section="delivery-challan">
                                <i class="fas fa-file-invoice"></i> Delivery Challan
                        </li>

                    </ul>
                </div>

                <div class="nav-section">
                    <p class="nav-title" style="margin: 10px 0; font-weight: bold;">Settings</p>
                    <ul class="nav-list" style="list-style: none; padding: 0;">
                        <li>
                            <button class="nav-item" data-section="preferences">
                                <i class="fas fa-cog"></i> Preferences
                            </button>
                        </li>
                        <li>
                            <button class="nav-item" data-section="user-management">
                                <i class="fas fa-users"></i> User Management
                            </button>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2>Customer Service Portal</h2>
                </div>
                <div class="header-right">
                    <button class="refresh-btn" id="headerRefreshBtn" title="Refresh Dashboard">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search customers, jobs...">
                    </div>
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                    </button>
                    <div class="user-profile">
                        <div class="user-avatar" onclick="toggleUserDropdown()">JD</div>
                        <div class="user-info">
                            <div class="user-name">John Doe</div>
                            <div class="user-role">Administrator</div>
                        </div>

                         <!-- User Dropdown Menu -->
                         <div class="user-dropdown" id="userDropdown">
                            <div class="dropdown-item" id="changePasswordBtn">
                                <i class="fas fa-key"></i>
                                <span>Change Password</span>
                            </div>
                            <div class="dropdown-item" id="logoutBtn">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </div>
                        </div>

                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="content">
                <!-- Dashboard Overview -->
                <div id="overview" class="section active">
                    <div class="section-header">
                        <h3>Dashboard Overview</h3>
                        <p>Welcome back! Here's what's happening with your service requests.</p>
                    </div>

                    <!-- Stats Grid -->
                    <div class="stats-grid">
                        <div class="stat-card clickable-counter" data-counter="customers">
                            <div class="stat-content">
                                <div>
                                    <div class="stat-label">Total Customers</div>
                                    <div class="stat-value" id="totalCustomers">1,234</div>
                                </div>
                                <div class="stat-icon blue">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card clickable-counter" data-counter="active">
                            <div class="stat-content">
                                <div>
                                    <div class="stat-label">Active Jobs</div>
                                    <div class="stat-value" id="activeJobs">89</div>
                                </div>
                                <div class="stat-icon orange">
                                    <i class="fas fa-cog"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card clickable-counter" data-counter="completed">
                            <div class="stat-content">
                                <div>
                                    <div class="stat-label">Completed Jobs</div>
                                    <div class="stat-value" id="completedJobs">567</div>
                                </div>
                                <div class="stat-icon green">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card clickable-counter" data-counter="pending">
                            <div class="stat-content">
                                <div>
                                    <div class="stat-label">Pending Jobs</div>
                                    <div class="stat-value" id="pendingJobs">23</div>
                                </div>
                                <div class="stat-icon yellow">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Counter Details Container -->
                    <div id="counterDetails" style="display: none;"></div>



                    <!-- Dashboard Grid -->
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h4><i class="fas fa-chart-line"></i> Recent Activity</h4>
                                <p>Latest system activities</p>
                            </div>
                            <div class="card-content">
                                <div class="activity-list">
                                    <div class="activity-item">
                                        <div class="activity-dot green"></div>
                                        <div class="activity-content">
                                            <div class="activity-title">New complaint registered</div>
                                            <div class="activity-subtitle">Customer: John Doe</div>
                                        </div>
                                        <div class="activity-time">2 min ago</div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-dot blue"></div>
                                        <div class="activity-content">
                                            <div class="activity-title">Engineer assigned</div>
                                            <div class="activity-subtitle">Job ID: IN170625000001</div>
                                        </div>
                                        <div class="activity-time">5 min ago</div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-dot orange"></div>
                                        <div class="activity-content">
                                            <div class="activity-title">Job completed</div>
                                            <div class="activity-subtitle">Customer: Jane Smith</div>
                                        </div>
                                        <div class="activity-time">10 min ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Updated Quick Actions -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Quick Actions</h4>
                            </div>
                            <div class="card-content">
                                <div class="quick-actions">
                                    <button class="quick-action-btn" data-action="register-complaint">
                                        <i class="fas fa-phone"></i>
                                        <p>Register Complaint</p>
                                    </button>
                                    <button class="quick-action-btn" data-action="view-jobs">
                                        <i class="fas fa-history"></i>
                                        <p>View Job History</p>
                                    </button>
                                    <button class="quick-action-btn" data-action="view-service-centers">
                                        <i class="fas fa-building"></i>
                                        <p>Service Centers</p>
                                    </button>
                                    <button class="quick-action-btn" data-action="add-engineer">
                                        <i class="fas fa-users-cog"></i>
                                        <p>Manage Engineers</p>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Complaint/Job Sheet Section with Product Storage -->
                <div id="complaint" class="section">
                    <div class="section-header">
                        <h3>New Complaint / Job Registration</h3>
                        <p>Register a new service request and automatically save product details</p>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-phone"></i> Complaint / Job Sheet</h4>
                        </div>
                        <div class="card-content">
                            <form id="callForm">
                                <!-- Call Type -->
                                <div class="form-section">
                                    <label class="section-label">Call Type*</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="callType" value="IN" />
                                            <span>Installation</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="callType" value="IN" />
                                            <span>Reinstallation</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="callType" value="IN" />
                                            <span>Demo</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="callType" value="RE" />
                                            <span>Repairs</span>
                                        </label>
                                    </div>
                                    <div id="callType" class="error-message"></div>
                                </div>

                                <!-- Customer Information Section -->
                                <div class="form-section">
                                    <h5
                                        style="color: #1e293b; margin-bottom: 16px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">
                                        <i class="fas fa-user"></i> Customer Information
                                    </h5>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="fullName">Full Name*</label>
                                            <input type="text" id="fullName" placeholder="Enter full name" required />
                                            <div id="fullName" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="mobile">Mobile Number*</label>
                                            <input type="text" id="mobile" placeholder="10-digit number" required />
                                            <div id="mobile" class="error-message"></div>
                                        </div>
                                    </div>

                                    <!-- Address Information -->
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="houseNo">House/Flat No*</label>
                                            <input type="text" id="houseNo" placeholder="Enter house/flat number"
                                                required />
                                            <div id="houseNo" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="street">Street, Area, Sector*</label>
                                            <input type="text" id="street" placeholder="Enter street name" required />
                                            <div id="streetError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="landmark">Landmark</label>
                                            <input type="text" id="landmark" placeholder="E.g., near apollo hospital" />
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="pin">Pin Code*</label>
                                            <input type="text" id="pin" placeholder="6-digit pincode" required
                                                maxlength="6" />
                                            <div id="pinError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="locality">Locality*</label>
                                            <select id="locality" required>
                                                <option value="">-- Select locality --</option>
                                            </select>
                                            <div id="localityError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="city">City*</label>
                                            <input type="text" id="city" placeholder="City" readonly />
                                            <div id="cityError" class="error-message"></div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="stateVisible">State*</label>
                                            <input type="text" id="stateVisible"
                                                placeholder="State will appear here automatically by Pincode" readonly
                                                style="background-color: #f1f1f1;" />
                                            <select id="stateSelect" required style="display: none;">
                                                <option value="">-- Select State --</option>
                                                <option value="01">JAMMU AND KASHMIR</option>
                                                <option value="02">HIMACHAL PRADESH</option>
                                                <option value="03">PUNJAB</option>
                                                <option value="04">CHANDIGARH</option>
                                                <option value="05">UTTARAKHAND</option>
                                                <option value="06">HARYANA</option>
                                                <option value="07">DELHI</option>
                                                <option value="08">RAJASTHAN</option>
                                                <option value="09">UTTAR PRADESH</option>
                                                <option value="10">BIHAR</option>
                                                <option value="11">SIKKIM</option>
                                                <option value="12">ARUNACHAL PRADESH</option>
                                                <option value="13">NAGALAND</option>
                                                <option value="14">MANIPUR</option>
                                                <option value="15">MIZORAM</option>
                                                <option value="16">TRIPURA</option>
                                                <option value="17">MEGHALAYA</option>
                                                <option value="18">ASSAM</option>
                                                <option value="19">WEST BENGAL</option>
                                                <option value="20">JHARKHAND</option>
                                                <option value="21">ODISHA</option>
                                                <option value="22">CHATTISGARH</option>
                                                <option value="23">MADHYA PRADESH</option>
                                                <option value="24">GUJARAT</option>
                                                <option value="26">DADRA AND NAGAR HAVELI AND DAMAN AND DIU</option>
                                                <option value="27">MAHARASHTRA</option>
                                                <option value="28">ANDHRA PRADESH</option>
                                                <option value="29">KARNATAKA</option>
                                                <option value="30">GOA</option>
                                                <option value="31">LAKSHADWEEP</option>
                                                <option value="32">KERELA</option>
                                                <option value="33">TAMIL NADU</option>
                                                <option value="34">PUDUCHERRY</option>
                                                <option value="35">ANDAMAN AND NICOBAR ISLANDS</option>
                                                <option value="36">TELANGANA</option>
                                                <option value="37">ANDHRA PRADESH</option>
                                                <option value="38">LADAKH</option>
                                                <option value="97">OTHER TERRITORY</option>
                                                <option value="99">CENTRE JURISDICTION</option>
                                            </select>
                                            <div id="stateSelectError" class="error-message"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Product Information Section -->
                                <div class="form-section">
                                    <h5
                                        style="color: #1e293b; margin-bottom: 16px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">
                                        <i class="fas fa-box"></i> Product Information
                                        <small style="color: #64748b; font-weight: normal;">(This product will be
                                            automatically saved to your account)</small>
                                    </h5>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="productType">Product Type*</label>
                                            <select id="productType" required>
                                                <option value="">-- Select Product Type --</option>
                                                <option value="GATEWAY">GATEWAY</option>
                                                <option value="IR BLASTER">IR BLASTER</option>
                                                <option value="SMART RETROFIT">SMART RETROFIT</option>
                                                <option value="SMART COB">SMART COB</option>
                                                <option value="SMART PANEL">SMART PANEL</option>
                                                <option value="SMART STRIP">SMART STRIP</option>
                                                <option value="SMART CAMERA">SMART CAMERA</option>
                                                <option value="SMART DOORBELL">SMART DOORBELL</option>
                                                <option value="SMART DOOR LOCK">SMART DOOR LOCK</option>
                                            </select>
                                            <div id="productTypeError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="productName">Product Name*</label>
                                            <select id="productName" required>
                                                <option value="">-- Select Product Name --</option>
                                            </select>
                                            <div id="productNameError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="symptoms">Symptoms*</label>
                                            <select id="symptoms" required>
                                                <option value="">-- Select Symptoms --</option>
                                                <option value="Engineer visit for Installation">Installation Request
                                                </option>
                                                <option value="Repair">Repair Request</option>
                                            </select>
                                            <div id="symptomsError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="modelNo">Model No.*</label>
                                            <input type="text" id="modelNo" placeholder="Enter model number" required />
                                            <div id="modelNoError" class="error-message"></div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="serial">Serial Number</label>
                                            <input type="text" id="serial" placeholder="E.g., AB123456789" />
                                            <div id="serialError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="manufacturer">Brand*</label>
                                            <input type="text" id="manufacturer" placeholder="E.g., Samsung, LG, Apple"
                                                required />
                                            <div id="manufacturerError" class="error-message"></div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="purchaseDate">Date of Purchase*</label>
                                            <input type="date" id="purchaseDate" required />
                                            <div id="purchaseDateError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="warrantyExpiry">Warranty*</label>
                                            <select id="warrantyExpiry" required>
                                                <option value="">-- Select Warranty Status --</option>
                                                <option value="in_warranty">In Warranty</option>
                                                <option value="out_of_warranty">Out of Warranty</option>
                                                <option value="unknown">Warranty Void</option>
                                            </select>
                                            <div id="warrantyExpiryError" class="error-message"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Service Information Section -->
                                <div class="form-section">
                                    <h5
                                        style="color: #1e293b; margin-bottom: 16px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">
                                        <i class="fas fa-calendar"></i> Service Information
                                    </h5>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="availableDate">Customer Available Date*</label>
                                            <input type="date" id="availableDate" required />
                                            <div id="availableDateError" class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="preferredTime">Preferred Time Slot*</label>
                                            <select id="preferredTime" required>
                                                <option value="">-- Select time slot --</option>
                                                <option value="10am-1pm">10 AM – 1 PM</option>
                                                <option value="2pm-4pm">2 PM – 4 PM</option>
                                                <option value="4pm-7pm">4 PM – 7 PM</option>
                                            </select>
                                            <div id="preferredTimeError" class="error-message"></div>
                                        </div>
                                    </div>

                                    <!-- Optional Comments -->
                                    <div class="form-group">
                                        <label for="comments">Additional Comments</label>
                                        <textarea id="comments" rows="3"
                                            placeholder="Any additional information or special instructions..."></textarea>
                                    </div>

                                    <!-- Call Priority -->
                                    <div class="form-section">
                                        <label class="section-label">Call Priority*</label>
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="priority" value="Normal" />
                                                <span>Normal</span>
                                            </label>
                                            <label class="radio-label urgent">
                                                <input type="radio" name="priority" value="Urgent" />
                                                <span>Urgent</span>
                                            </label>
                                        </div>
                                        <div id="priority" class="error-message"></div>
                                    </div>
                                </div>

                                <!-- Submit Button -->
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-phone"></i> Register Call & Save Product
                                    </button>
                                    <button type="button" class="btn btn-outline" id="resetBtn">
                                        <i class="fas fa-undo"></i> Reset Form
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Job History Section -->
                <div id="job-history" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Job History</h3>
                            <p>Search and track all service requests by customer details</p>
                        </div>
                        <button class="btn btn-primary" id="createNewJobBtn">Create New Job</button>
                    </div>

                    <!-- Customer Search Card -->
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <h4><i class="fas fa-search"></i> Search Customer Jobs</h4>
                        </div>
                        <div class="card-content">
                            <form id="customerSearchForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="searchCustomerName">Customer Name*</label>
                                        <input type="text" id="searchCustomerName"
                                            placeholder="Enter customer full name" required />
                                        <div id="searchCustomerNameError" class="error-message"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="searchMobile">Mobile Number*</label>
                                        <input type="text" id="searchMobile" placeholder="10-digit mobile number"
                                            required />
                                        <div id="searchMobileError" class="error-message"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="searchPincode">Pin Code*</label>
                                        <input type="text" id="searchPincode" placeholder="6-digit pincode" required />
                                        <div id="searchPincodeError" class="error-message"></div>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-search"></i> Search Jobs
                                    </button>
                                    <button type="button" class="btn btn-outline" id="clearSearchBtn">
                                        <i class="fas fa-times"></i> Clear Search
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Jobs Results Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="table-header">
                                <h4>Service Jobs</h4>
                                <div class="search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="jobTableSearch" placeholder="Search in results...">
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <!-- Loading indicator -->
                            <div id="loadingIndicator" style="display: none; text-align: center; padding: 20px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #2563eb;"></i>
                                <p style="margin-top: 10px; color: #64748b;">Searching for customer jobs...</p>
                            </div>

                            <!-- No results message -->
                            <div id="noResultsMessage" style="display: none; text-align: center; padding: 40px;">
                                <i class="fas fa-search"
                                    style="font-size: 48px; color: #cbd5e1; margin-bottom: 16px;"></i>
                                <h4 style="color: #64748b; margin-bottom: 8px;">No Jobs Found</h4>
                                <p style="color: #9ca3af;">Enter customer details above to search for their service
                                    history.</p>
                            </div>

                            <!-- Jobs table -->
                            <div class="table-container" id="jobsTableContainer">
                                <table class="jobs-table" id="jobsTable">
                                    <thead>
                                        <tr>
                                            <th>Job ID</th>
                                            <th>Customer Details</th>
                                            <th>Service Type</th>
                                            <th>Status</th>
                                            <th>Priority</th>
                                            <th>Technician</th>
                                            <th>Created Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="jobsTableBody">
                                        <!-- Dynamic content will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- NEW: List Service Centers Section -->
                <div id="list-service-centers" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Service Centers</h3>
                            <p>View and manage service centers by pin code</p>
                        </div>
                    </div>

                    <!-- Search Service Centers Card -->
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <h4><i class="fas fa-search"></i> Search Service Centers</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group" style="max-width: 300px;">
                                    <label for="serviceCenterPinCode">Pin Code*</label>
                                    <div style="display: flex; gap: 12px;">
                                        <input type="text" id="serviceCenterPinCode" placeholder="6-digit pincode"
                                            maxlength="6" required />
                                        <button type="button" class="btn btn-primary" id="searchServiceCentersBtn">
                                            <i class="fas fa-search"></i> Search
                                        </button>
                                        <button type="button" class="btn btn-outline" id="clearServiceCenterSearchBtn">
                                            <i class="fas fa-times"></i> Clear
                                        </button>
                                    </div>
                                    <div id="pinError" class="error-message"></div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Service Centers Results -->
                    <div class="card">
                        <div class="card-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <h4>Service Centers</h4>
                                <!-- Job Status Tabs -->
                                <div class="job-status-tabs">
                                    <button class="tab-btn active" data-status="all">All Centers</button>
                                    <button class="tab-btn" data-status="active">Active Centers</button>
                                    <button class="tab-btn" data-status="pending">Pending Approval</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <!-- Loading indicator -->
                            <div id="serviceCenterLoadingIndicator" style="display: none; text-align: center; padding: 20px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #2563eb;"></i>
                                <p style="margin-top: 10px; color: #64748b;">Searching for service centers...</p>
                            </div>

                            <!-- No results message -->
                            <div id="noServiceCentersMessage" style="display: none; text-align: center; padding: 40px;">
                                <i class="fas fa-building" style="font-size: 48px; color: #cbd5e1; margin-bottom: 16px;"></i>
                                <h4 style="color: #64748b; margin-bottom: 8px;">No Service Centers Found</h4>
                                <p style="color: #9ca3af;">Enter a pincode above to search for service centers in that area.</p>
                            </div>

                            <!-- Service Centers Table -->
                            <div class="table-container" id="serviceCentersTableContainer">
                                <table class="jobs-table" id="serviceCentersTable">
                                    <thead>
                                        <tr>
                                            <th>Center ID</th>
                                            <th>Partner Name</th>
                                            <th>Operating Pincodes</th>
                                            <th>Contact Person</th>
                                            <th>Email & Services</th>
                                            <th>Phone</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="partnersListTable">
                                        <!-- Dynamic content will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: Service Partners Section -->
                <div id="service-partners" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Service Partners</h3>
                            <p>Add and manage service partners</p>
                        </div>
                        <button class="btn btn-primary" id="viewAllPartnersBtn">View All Partners</button>
                    </div>

                    <!-- Add New Service Partner Card -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-plus"></i> Add New Service Partner</h4>
                            <p style="color: #64748b; font-size: 14px; margin: 4px 0 0;">Register new service partners
                            </p>
                        </div>
                        <div class="card-content">
                            <form id="addServicePartnerForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Company Name *</label>
                                        <input type="text" id="companyName" class="form-control" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Contact Person *</label>
                                        <input type="text" id="contactPerson" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Email Address *</label>
                                        <input type="email" id="partnerEmail" class="form-control" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Phone Number *</label>
                                        <input type="tel" id="partnerPhone" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>GST Number *</label>
                                        <input type="text" id="gstNumber" class="form-control" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>PAN Number *</label>
                                        <input type="text" id="panNumber" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Aadhar Card Number *</label>
                                        <input type="text" id="aadharNumber" class="form-control" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Operating PIN Codes *</label>
                                    <div class="pin-codes-input-container">
                                        <div class="pin-codes-display" id="pinCodesDisplay"></div>
                                        <div class="form-row">
                                            <div class="form-group" style="flex: 1;">
                                                <input type="file" id="pinCodesCSV" class="form-control" accept=".csv"
                                                    onchange="handleCSVUpload(event)">
                                                <small style="color: #64748b;">Upload CSV file with PIN codes and
                                                    Product</small>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Company Address *</label>
                                    <textarea id="partnerAddress" class="form-control" rows="3" required></textarea>
                                </div>

                                <!-- Document Upload Section -->
                                <div class="form-section">
                                    <h5 class="section-label">Document Attachments *</h5>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>GST Certificate</label>
                                            <input type="file" id="gstCertificate" class="form-control"
                                                accept=".pdf,.jpg,.jpeg,.png" required>
                                        </div>
                                        <div class="form-group">
                                            <label>PAN Card</label>
                                            <input type="file" id="panCard" class="form-control"
                                                accept=".pdf,.jpg,.jpeg,.png" required>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Aadhar Card</label>
                                            <input type="file" id="aadharCard" class="form-control"
                                                accept=".pdf,.jpg,.jpeg,.png" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Company Registration Certificate</label>
                                            <input type="file" id="companyCertificate" class="form-control"
                                                accept=".pdf,.jpg,.jpeg,.png">
                                        </div>
                                    </div>
                                </div>

                                <!-- Approval Status Display -->
                                <div class="form-group" id="partnerApprovalStatusGroup" style="display: none;">
                                    <label>Approval Status</label>
                                    <div id="partnerApprovalStatus" class="badge badge-warning">Pending Admin Approval
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="button" class="btn btn-outline" onclick="resetPartnerForm()">
                                        <i class="fas fa-undo"></i> Reset
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i> Submit for Approval
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Job Transfer Section -->
                <div id="job-transfer" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Job Transfer</h3>
                            <p>Transfer service requests between service centers</p>
                        </div>
                    </div>


                    <!-- Transfer Form -->
                    <div class="form-card">
                        <div class="card-header">
                            <h4><i class="fas fa-exchange-alt"></i> Transfer Job</h4>
                            <p>Transfer a job from one service center to another</p>
                        </div>
                        <div class="card-content">
                            <form id="jobTransferForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="transferComplaintId">Complaint ID *</label>
                                        <input type="text" id="transferComplaintId" name="transferComplaintId"
                                            placeholder="e.g., IN170625000001 or RE170625000001" required>
                                        <small style="color: #64748b; font-size: 12px;">Format: IN/RE + Date + Month +
                                            Sequential Number</small>
                                    </div>

                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="currentServiceCenter">Current Service Center Username *</label>
                                        <input type="text" id="currentServiceCenter" name="currentServiceCenter"
                                            placeholder="Enter current SVC username" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="targetServiceCenter">Target Service Center Username *</label>
                                        <input type="text" id="targetServiceCenter" name="targetServiceCenter"
                                            placeholder="Enter target SVC username" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="transferReason">Transfer Reason *</label>
                                    <textarea id="transferReason" name="transferReason" rows="4"
                                        placeholder="Explain why this job needs to be transferred..."
                                        required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="transferNotes">Additional Notes</label>
                                    <textarea id="transferNotes" name="transferNotes" rows="3"
                                        placeholder="Any additional information for the receiving service center..."></textarea>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-exchange-alt"></i> Transfer Job
                                    </button>
                                    <button type="reset" class="btn btn-outline">
                                        <i class="fas fa-undo"></i> Reset Form
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Transfer History -->
                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Jobs</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="transferFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="transferToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Current Service Center</label>
                                    <select id="currentServiceCenter" class="form-control">
                                        <option value="">All Centers</option>
                                        <option value="svc_delhi">SVC Delhi</option>
                                        <option value="svc_mumbai">SVC Mumbai</option>
                                        <option value="svc_bangalore">SVC Bangalore</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary" onclick="filterTransferJobs()">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-history"></i> Transfer History</h4>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Current Center</th>
                                            <th>Target Center</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="transferHistoryTable">
                                        <!--

                                        <tr>
                                            <td class="job-id">IN170625000007</td>
                                            <td>Alex Kumar<br><small>9876543216</small></td>
                                            <td>svc_delhi</td>
                                            <td>svc_mumbai</td>
                                            <td>17/06/2025</td>
                                            <td>Location Change</td>
                                            <td>
                                                <button class="action-btn view-complaint-btn" onclick="viewComplaintDetail('IN170625000007')" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="viewTransferDetails('IN170625000007')" title="Transfer Details">
                                                    <i class="fas fa-info-circle"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    -->

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Add Engineer Section -->
                <div id="add-engineer" class="section">
                    <div class="section-header">
                        <div>
                            <h4>Add New Engineer</h4>
                            <p>Register new engineers in the system</p>
                        </div>
                    </div>
                    <div class="form-card">
                        <div class="card-content">
                            <form id="addEngineerForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Engineer ID</label>
                                        <input type="text" id="engineerId" class="form-control" readonly placeholder="Auto-generated">
                                    </div>
                                    <div class="form-group">
                                        <label for="engineerName">Engineer Name*</label>
                                        <input type="text" id="engineerName" name="name" placeholder="Enter full name"
                                            class="form-control" required />
                                        <div id="engineerNameError" class="error-message"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="engineerMobile">Phone Number*</label>
                                        <input type="text" id="engineerMobile" name="phone"
                                            placeholder="10-digit mobile number" class="form-control" required />
                                        <div id="engineerMobileError" class="error-message"></div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="engineerEmail">Email Address *</label>
                                        <input type="email" id="engineerEmail" name="email"
                                            placeholder="Enter your Email" class="form-control" required>
                                        <div class="error-message" id="engineerEmail-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="engineerSpecialization">Specialization *</label>
                                        <select id="engineerSpecialization" name="specialization" class="form-control"
                                            required>
                                            <option value="">Select Specialization</option>
                                            <option value="DTH Installation">DTH Installation</option>
                                            <option value="Repair & Maintenance">Repair & Maintenance</option>
                                            <option value="Cable TV">Cable TV</option>
                                            <option value="Internet Services">Internet Services</option>
                                        </select>
                                        <div class="error-message" id="engineerSpecialization-error"></div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="engineerExperience">Experience *</label>
                                        <input type="text" id="engineerExperience" name="experience"
                                            class="form-control" placeholder="e.g., 3 years" required>
                                        <div class="error-message" id="engineerExperience-error"></div>
                                    </div>
                                </div>

                                <!-- Operating Locations -->
                                <div class="form-group">
                                    <label for="operatingLocations">Operating Locations*</label>
                                    <div class="location-input-container">
                                        <div class="locations-display" id="locationsDisplay">
                                            <!-- Location tags will be displayed here -->
                                        </div>
                                        <div class="location-input-row">
                                            <input type="text" id="locationInput"
                                                placeholder="Add location and press Enter" />
                                            <button type="button" class="btn btn-outline" id="addLocationBtn">Add
                                                Location</button>
                                        </div>
                                    </div>
                                    <div id="operatingLocationsError" class="error-message"></div>
                                </div>

                                <!-- File Upload -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Aadhar Card * (PDF/JPEG only)</label>
                                        <div class="file-upload-area">
                                            <div class="upload-icon">
                                                <i class="fas fa-cloud-upload-alt"></i>
                                            </div>
                                            <p>Click to upload or drag and drop</p>
                                            <input type="file" name="aadharCard" accept=".pdf,.jpeg,.jpg"
                                                style="display: none;" required>
                                        </div>
                                        <div class="error-message" id="aadharCard-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label>PAN Card * (PDF/JPEG only)</label>
                                        <div class="file-upload-area">
                                            <div class="upload-icon">
                                                <i class="fas fa-cloud-upload-alt"></i>
                                            </div>
                                            <p>Click to upload or drag and drop</p>
                                            <input type="file" name="panCard" accept=".pdf,.jpeg,.jpg"
                                                style="display: none;" required>
                                        </div>
                                        <div class="error-message" id="panCard-error"></div>
                                    </div>
                                </div>

                                <!-- Approval Status Display -->
                                <div class="form-group" id="approvalStatusGroup" style="display: none;">
                                    <label>Approval Status</label>
                                    <div id="approvalStatus" class="badge badge-warning">Pending Admin Approval</div>
                                </div>

                                <div class="form-actions">
                                    <button type="button" class="btn btn-outline" onclick="resetEngineerForm()">
                                        <i class="fas fa-undo"></i> Reset
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i> Submit for Approval
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Engineer List Section -->
                <div id="engineer-list" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Engineer List</h3>
                            <p>Manage and monitor engineer information</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th>Engineer ID</th>
                                            <th>Name</th>
                                            <th>Phone</th>
                                            <th>Email</th>
                                            <th>Location</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Data will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Unassigned Complaints Section -->
                <section id="unassigned-complaints" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Unassigned Complaints</h3>
                            <p>Manage unassigned service complaints</p>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="unassignedFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="unassignedToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Service Type</label>
                                    <select id="unassignedServiceType" class="form-control">
                                        <option value="">All Types</option>
                                        <option value="Installation">Installation</option>
                                        <option value="Reinstallation">Reinstallation</option>
                                        <option value="Demo">Demo</option>
                                        <option value="Repair">Repair</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary" onclick="filterUnassignedComplaints()">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Complaints Table -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-list"></i> Unassigned Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox"></th>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Service Type</th>
                                            <th>Location</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="unassignedComplaintsTable">

                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">IN170625000001</td>
                                            <td>John Doe<br><small>9876543210</small></td>
                                            <td><span class="badge badge-primary">Installation</span></td>
                                            <td>Delhi 110001</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-warning">High</span></td>
                                            <td>
                                                <button class="action-btn"
                                                    onclick="viewComplaintDetail('IN170625000001')"
                                                    title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="openAssignEngineerModal('IN170625000001')"
                                                    title="Assign Engineer">
                                                    <i class="fas fa-user-plus"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">RE170625000002</td>
                                            <td>Jane Smith<br><small>9876543211</small></td>
                                            <td><span class="badge badge-danger">Repair</span></td>
                                            <td>Mumbai 400001</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-danger">Urgent</span></td>
                                            <td>
                                                <button class="action-btn"
                                                    onclick="viewComplaintDetail('RE170625000002')"
                                                    title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="openAssignEngineerModal('RE170625000002')"
                                                    title="Assign Engineer">
                                                    <i class="fas fa-user-plus"></i>
                                                </button>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Complaint Detail Section (Initially Hidden) -->
                <!-- <div id="complaintDetailCard" class="complaint-detail-wrapper" style="display: none;">
                    <h2>Complaint Details</h2>
                    <div id="complaintDetailGrid" class="grid-container"> -->
                <!-- JavaScript will inject cards here -->
                <!-- </div>
                </div> -->

                <!-- 
                <div id="complaintDetailCard" class="complaint-detail-wrapper" style="display: none; margin-top: 30px;">
                    <h3>Complaint Details</h3>
                    <div id="complaintDetailGrid" class="grid-container"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 16px;">
                    </div>
                </div> -->


                <!-- Engineer Assignment Modal -->
                <div id="assignEngineerModal" class="modal-overlay" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Assign Engineer</h3>
                            <button class="modal-close" onclick="closeAssignEngineerModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Complaint ID</label>
                                <input type="text" id="assignComplaintId" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label>Select Engineer</label>
                                <select id="engineerSelect" class="form-control">
                                    <option value="">Choose an engineer...</option>
                                    <option value="EN000001">EN000001 - John Smith (Delhi)</option>
                                    <option value="EN000002">EN000002 - Mike Wilson (Mumbai)</option>
                                    <option value="EN000003">EN000003 - Sarah Johnson (Bangalore)</option>
                                    <option value="EN000004">EN000004 - David Brown (Chennai)</option>
                                    <option value="EN000005">EN000005 - Lisa Davis (Pune)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Priority Level</label>
                                <select id="prioritySelect" class="form-control">
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Scheduled Date</label>
                                <input type="date" id="scheduledDate" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Scheduled Time</label>
                                <input type="time" id="scheduledTime" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Assignment Notes</label>
                                <textarea id="assignmentNotes" class="form-control" rows="3" placeholder="Add any special instructions or notes for the engineer..."></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-outline" onclick="closeAssignEngineerModal()">Cancel</button>
                            <button class="btn btn-primary" onclick="assignEngineerToComplaint()">Assign Engineer</button>
                        </div>
                    </div>
                </div>




                <!-- Pending Complaints Section -->
                <section id="pending-complaints" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Pending Complaints</h3>
                            <p>Manage complaints that are currently being processed</p>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="pendingFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="pendingToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Service Type</label>
                                    <select id="pendingServiceType" class="form-control">
                                        <option value="">All Types</option>
                                        <option value="Installation">Installation</option>
                                        <option value="Reinstallation">Reinstallation</option>
                                        <option value="Demo">Demo</option>
                                        <option value="Repair">Repair</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary" onclick="filterPendingComplaints()">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Complaints Table -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-clock"></i> Pending Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox"></th>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Service Type</th>
                                            <th>Location</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pendingComplaintsTable">
                                        
                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">IN170625000003</td>
                                            <td>Mike Johnson<br><small>9876543212</small></td>
                                            <td><span class="badge badge-primary">Installation</span></td>
                                            
                                            <td>Bangalore 560001</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-warning">In Progress</span></td>
                                            <td>
                                                <button class="action-btn" onclick="viewComplaintDetail('IN170625000003')" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="updateComplaintStatus('IN170625000003')" title="Update Status">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>


                <!-- Complaint Detail Card -->
                <div id="complaintDetailCard" class="complaint-detail-wrapper detail-section"
                    style="display: none; margin-top: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h3>Complaint Details</h3>
                        <button onclick="closeComplaintDetail()"
                            style="background:#dc3545; color:white; border:none; padding:4px 12px; font-size:16px; border-radius:4px; cursor:pointer;">
                            &times;
                        </button>
                    </div>
                    <div id="complaintDetailGrid" class="grid-container"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 16px;">
                    </div>
                </div>


                <!-- Assigned Complaints Section -->
                <section id="assigned-complaints" class="section" data-section="assigned-complaints">
                    <div class="section-header">
                        <div>
                            <h3>Assigned Complaints</h3>
                            <p>Manage complaints that have been assigned to engineers</p>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="assignedFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="assignedToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Assigned Engineer</label>
                                    <select id="assignedEngineer" class="form-control">
                                        <option value="">All Engineers</option>
                                        <option value="engineer1">John Smith</option>
                                        <option value="engineer2">Sarah Johnson</option>
                                        <option value="engineer3">Mike Wilson</option>
                                        <option value="engineer4">Lisa Brown</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Service Type</label>
                                    <select id="pendingServiceType" class="form-control">
                                        <option value="">All Types</option>
                                        <option value="Installation">Installation</option>
                                        <option value="Reinstallation">Reinstallation</option>
                                        <option value="Demo">Demo</option>
                                        <option value="Repair">Repair</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Complaints Table -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-user-check"></i> Assigned Complaints</h4>
                        </div>
                        <div class="card-content">
                            <!-- Loading Indicator -->
                            <div id="assignedLoadingIndicator" style="display: none; text-align: center; padding: 20px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #2563eb;"></i>
                                <p style="margin-top: 10px; color: #64748b;">Loading assigned complaints...</p>
                            </div>

                            <div class="table-container" id="assignedComplaintsTableContainer">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox"></th>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Service Type</th>
                                            <th>Location</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="assignedComplaintsTable">
                                        <!-- Sample data for demonstration -->
                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">RE170625000004</td>
                                            <td>Sarah Wilson<br><small>9876543213</small></td>
                                            <td><span class="badge badge-info">Repair</span></td>
                                            <td>John Smith</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-info">Assigned</span></td>
                                            <td>
                                                <button class="action-btn" onclick="viewComplaintDetail('RE170625000004')" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="updateAssignedStatus('RE170625000004')" title="Update Status">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn" onclick="requestParts('RE170625000004')" title="Request Parts">
                                                    <i class="fas fa-tools"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Complete Complaints Section -->
                <section id="complete-complaints" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Complete Complaints</h3>
                            <p>View successfully resolved complaints</p>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="completedFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="completedToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Service Type</label>
                                    <select id="completedServiceType" class="form-control">
                                        <option value="">All Types</option>
                                        <option value="Installation">Installation</option>
                                        <option value="Reinstallation">Reinstallation</option>
                                        <option value="Demo">Demo</option>
                                        <option value="Repair">Repair</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary" onclick="filterCompletedComplaints()">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Complaints Table -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-check-circle"></i> Completed Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox"></th>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Service Type</th>
                                            <th>Location</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="completedComplaintsTable">
                                        
                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">IN170625000005</td>
                                            <td>Robert Brown<br><small>9876543214</small></td>
                                            <td><span class="badge badge-success">Installation</span></td>
                                            <td>Hyderabad 500001</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-success">Completed</span></td>
                                            <td>
                                                <button class="action-btn" onclick="viewComplaintDetail('IN170625000005')" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="downloadReport('IN170625000005')" title="Download Report">
                                                    <i class="fas fa-download"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cancelled Complaints Section -->
                <section id="cancelled-complaints" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Cancelled Complaints</h3>
                            <p>View cancelled complaints</p>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-filter"></i> Filter Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Date</label>
                                    <input type="date" id="cancelledFromDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>To Date</label>
                                    <input type="date" id="cancelledToDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Cancellation Reason</label>
                                    <select id="cancelledReason" class="form-control">
                                        <option value="">All Reasons</option>
                                        <option value="Customer Request">Customer Request</option>
                                        <option value="Technical Issue">Technical Issue</option>
                                        <option value="Service Unavailable">Service Unavailable</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: end;">
                                    <button class="btn btn-primary" onclick="filterCancelledComplaints()">
                                        <i class="fas fa-search"></i> Apply Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Complaints Table -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-times-circle"></i> Cancelled Complaints</h4>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox"></th>
                                            <th>Complaint ID</th>
                                            <th>Customer</th>
                                            <th>Service Type</th>
                                            <th>Location</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cancelledComplaintsTable">
                                        
                                        <tr>
                                            <td><input type="checkbox" class="complaint-checkbox"></td>
                                            <td class="job-id">IN170625000006</td>
                                            <td>Lisa Davis<br><small>9876543215</small></td>
                                            <td><span class="badge badge-danger">Installation</span></td>
                                            <td>Kolkata 700001</td>
                                            <td>17/06/2025</td>
                                            <td><span class="badge badge-secondary">Cancelled</span></td>
                                            <td>
                                                <button class="action-btn" onclick="viewComplaintDetail('IN170625000006')" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="action-btn" onclick="reactivateComplaint('IN170625000006')" title="Reactivate">
                                                    <i class="fas fa-redo"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- NEW: Current Assignment Section (Engineer Dashboard) -->
                <div id="current-assignment" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Current Assignment</h3>
                            <p>Your currently assigned service job</p>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn btn-outline" id="refreshAssignmentBtn">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <button class="btn btn-primary" id="markCompleteBtn">
                                <i class="fas fa-check"></i> Mark as Complete
                            </button>
                        </div>
                    </div>

                    <!-- Job Status Overview -->
                    <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom: 24px;">
                        <div class="stat-card">
                            <div class="stat-content">
                                <div class="stat-text">
                                    <p class="stat-label">Job Status</p>
                                    <p class="stat-value" style="font-size: 18px; color: #2563eb;">In Progress</p>
                                </div>
                                <div class="stat-icon blue">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-content">
                                <div class="stat-text">
                                    <p class="stat-label">Progress</p>
                                    <p class="stat-value" style="font-size: 18px; color: #f59e0b;">60%</p>
                                </div>
                                <div class="stat-icon orange">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-content">
                                <div class="stat-text">
                                    <p class="stat-label">Service Type</p>
                                    <p class="stat-value" style="font-size: 18px; color: #16a34a;">Installation</p>
                                </div>
                                <div class="stat-icon green">
                                    <i class="fas fa-tools"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-content">
                                <div class="stat-text">
                                    <p class="stat-label">Job ID</p>
                                    <p class="stat-value" style="font-size: 18px; color: #7c3aed;">#1001</p>
                                </div>
                                <div class="stat-icon" style="background-color: #f3e8ff; color: #7c3aed;">
                                    <i class="fas fa-hashtag"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Job Details Card -->
                    <div class="card">
                        <div class="card-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h4>Job #1001 <span class="badge badge-primary">In Progress</span></h4>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    <button class="btn btn-outline" id="viewDetailsBtn">View Details</button>
                                    <button class="btn btn-primary" id="updateStatusBtn">Update Status</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <!-- Job Progress -->
                            <div class="job-progress-section">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: 500;">Job Progress</span>
                                    <span style="font-weight: 500; color: #2563eb;">60%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 60%;"></div>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                                <!-- Customer Information -->
                                <div>
                                    <h5 style="margin-bottom: 12px; color: #1e293b;">CUSTOMER INFORMATION</h5>
                                    <div class="info-card">
                                        <p><strong>Rajesh Kumar</strong></p>
                                        <p><i class="fas fa-phone"></i> +91 98765 43210</p>
                                        <p><i class="fas fa-map-marker-alt"></i> 123, Sector 15, Gurgaon, Haryana -
                                            122001</p>
                                    </div>

                                    <h5 style="margin: 16px 0 12px; color: #1e293b;">PROBLEM DESCRIPTION</h5>
                                    <div class="info-card">
                                        <p>Customer reports that the VSAT connection is intermittent. Signal strength
                                            appears to be weak during peak hours. Need to check dish alignment and cable
                                            connections.</p>
                                    </div>
                                </div>

                                <!-- Job Details -->
                                <div>
                                    <h5 style="margin-bottom: 12px; color: #1e293b;">JOB DETAILS</h5>
                                    <div class="info-card">
                                        <p><strong>Service Type:</strong> Installation</p>
                                        <p><strong>Scheduled:</strong> 12/06/2025</p>
                                        <p><strong>Time Slot:</strong> 10:00 AM - 1:00 PM</p>
                                    </div>

                                    <h5 style="margin: 16px 0 12px; color: #1e293b;">PRODUCT INFORMATION</h5>
                                    <div class="info-card">
                                        <p><strong>Product:</strong> VSAT Terminal</p>
                                        <p><strong>Model:</strong> VS-2000X</p>
                                        <p><strong>Serial:</strong> VST1001ABC</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: Update Status Section -->
                <div id="update-status" class="section">
                    <div class="section-header">
                        <h3>Update Job Status</h3>
                        <p>Update the status and progress of your assigned jobs</p>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                        <!-- Select Job Card -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Select Job</h4>
                                <p>Choose a job to update its status</p>
                            </div>
                            <div class="card-content">
                                <div class="form-group">
                                    <label for="jobSelect">Select a job</label>
                                    <select id="jobSelect">
                                        <option value="">Select a job</option>
                                        <option value="1001">Job #1001 - Rajesh Kumar</option>
                                        <option value="1002">Job #1002 - Priya Sharma</option>
                                        <option value="1003">Job #1003 - Amit Singh</option>
                                    </select>
                                </div>

                                <!-- Job Details Display -->
                                <div id="selectedJobDetails" style="display: none; margin-top: 16px;">
                                    <div class="job-card">
                                        <div class="job-header">
                                            <h5>Job #1001</h5>
                                            <span class="badge badge-primary">In Progress</span>
                                        </div>
                                        <div class="job-info">
                                            <p><strong>Customer:</strong> Rajesh Kumar</p>
                                            <p><strong>Phone:</strong> +91 98765 43210</p>
                                            <p><strong>Location:</strong> 123, Sector 15, Gurgaon, Haryana - 122001</p>
                                            <p><strong>Scheduled:</strong> 12/06/2025</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Update Job Status Card -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Update Job Status</h4>
                                <p>Provide details about the job progress and any issues encountered</p>
                            </div>
                            <div class="card-content">
                                <form id="updateJobStatusForm">
                                    <!-- Job Status -->
                                    <div class="form-section">
                                        <label class="section-label">Job Status</label>
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="jobStatus" value="Pending" />
                                                <span>Pending</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="jobStatus" value="In Progress" checked />
                                                <span>In Progress</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="jobStatus" value="On Hold" />
                                                <span>On Hold</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="jobStatus" value="Completed" />
                                                <span>Completed</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Progress Details -->
                                    <div class="form-section">
                                        <label class="section-label">Progress Details</label>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="completionPercentage">Completion Percentage</label>
                                                <select id="completionPercentage">
                                                    <option value="">Select completion %</option>
                                                    <option value="10">10%</option>
                                                    <option value="25">25%</option>
                                                    <option value="50">50%</option>
                                                    <option value="75">75%</option>
                                                    <option value="100">100%</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="timeSpent">Time Spent (Hours)</label>
                                                <input type="number" id="timeSpent" placeholder="Enter hours" min="0"
                                                    step="0.5" />
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Work Completed -->
                                    <div class="form-group">
                                        <label for="workCompleted">Work Completed</label>
                                        <textarea id="workCompleted" rows="3"
                                            placeholder="Describe the work completed so far..."></textarea>
                                    </div>

                                    <!-- Issues Encountered -->
                                    <div class="form-group">
                                        <label for="issuesEncountered">Issues Encountered</label>
                                        <textarea id="issuesEncountered" rows="3"
                                            placeholder="Describe any issues or challenges faced..."></textarea>
                                    </div>

                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save"></i> Update Status
                                        </button>
                                        <button type="button" class="btn btn-outline">
                                            <i class="fas fa-times"></i> Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: Request Parts Section -->
                <div id="request-parts" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Request Parts</h3>
                            <p>Request new parts and track existing requests</p>
                        </div>
                        <button class="btn btn-primary" id="newRequestBtn">
                            <i class="fas fa-plus"></i> New Request
                        </button>
                    </div>

                    <!-- Parts Request Tabs -->
                    <div class="parts-tabs">
                        <button class="tab-btn active" data-tab="new-request">New Request</button>
                        <button class="tab-btn" data-tab="pending-requests">Pending Requests</button>
                        <button class="tab-btn" data-tab="request-history">Request History</button>
                    </div>

                    <!-- New Request Tab -->
                    <div id="new-request" class="tab-content active">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                            <!-- Job Information -->
                            <div class="card">
                                <div class="card-header">
                                    <h4>Job Information</h4>
                                    <p>Select the job for which parts are needed</p>
                                </div>
                                <div class="card-content">
                                    <div class="form-group">
                                        <label for="partsJobSelect">Select Job</label>
                                        <select id="partsJobSelect">
                                            <option value="">Choose a job</option>
                                            <option value="1001">Job #1001 - Rajesh Kumar</option>
                                            <option value="1002">Job #1002 - Priya Sharma</option>
                                        </select>
                                    </div>

                                    <!-- Job Details Display -->
                                    <div id="partsJobDetails" style="display: none; margin-top: 16px;">
                                        <div class="job-card">
                                            <div class="job-header">
                                                <h5>Job #1001</h5>
                                                <span class="badge badge-primary">In Progress</span>
                                            </div>
                                            <div class="job-info">
                                                <p><strong>Customer:</strong> Rajesh Kumar</p>
                                                <p><strong>Service Type:</strong> Installation</p>
                                                <p><strong>Location:</strong> Gurgaon, Haryana</p>
                                                <p><strong>Product:</strong> VSAT Terminal VS-2000X</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Request Parts -->
                            <div class="card">
                                <div class="card-header">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h4>Request Parts</h4>
                                            <p>Add parts needed for the selected job</p>
                                        </div>
                                        <button class="btn btn-outline" id="addPartBtn">
                                            <i class="fas fa-plus"></i> Add Part
                                        </button>
                                    </div>
                                </div>
                                <div class="card-content">
                                    <!-- Required Parts Table -->
                                    <div class="form-section">
                                        <label class="section-label">Required Parts</label>
                                        <div class="parts-table-container">
                                            <table class="parts-table" id="partsTable">
                                                <thead>
                                                    <tr>
                                                        <th>Part Name</th>
                                                        <th>Part Number</th>
                                                        <th>Quantity</th>
                                                        <th>Priority</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="partsTableBody">
                                                    <tr>
                                                        <td>LNB Cable</td>
                                                        <td>LNB-001</td>
                                                        <td>2</td>
                                                        <td><span class="badge badge-success">Normal</span></td>
                                                        <td>
                                                            <button class="action-btn" onclick="removePart(this)">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Satellite Dish</td>
                                                        <td>DISH-75CM</td>
                                                        <td>1</td>
                                                        <td><span class="badge badge-danger">High</span></td>
                                                        <td>
                                                            <button class="action-btn" onclick="removePart(this)">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- Request Details -->
                                    <div class="form-section">
                                        <label class="section-label">Request Details</label>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="requestUrgency">Request Urgency</label>
                                                <select id="requestUrgency">
                                                    <option value="">Select urgency</option>
                                                    <option value="Low">Low</option>
                                                    <option value="Normal">Normal</option>
                                                    <option value="High">High</option>
                                                    <option value="Urgent">Urgent</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="deliveryLocation">Delivery Location</label>
                                                <select id="deliveryLocation">
                                                    <option value="">Select location</option>
                                                    <option value="Job Site">Job Site</option>
                                                    <option value="Service Center">Service Center</option>
                                                    <option value="Engineer Location">Engineer Location</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Reason for Request -->
                                    <div class="form-group">
                                        <label for="requestReason">Reason for Request</label>
                                        <textarea id="requestReason" rows="3"
                                            placeholder="Explain why these parts are needed..."></textarea>
                                    </div>

                                    <div class="form-actions">
                                        <button type="button" class="btn btn-primary" id="submitPartsRequestBtn">
                                            <i class="fas fa-paper-plane"></i> Submit Request
                                        </button>
                                        <button type="button" class="btn btn-outline">
                                            <i class="fas fa-times"></i> Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pending Requests Tab -->
                    <div id="pending-requests" class="tab-content">
                        <div class="card">
                            <div class="card-header">
                                <h4>Pending Parts Requests</h4>
                                <p>Track the status of your pending parts requests</p>
                            </div>
                            <div class="card-content">
                                <p style="text-align: center; color: #64748b; padding: 40px;">
                                    <i class="fas fa-clock"
                                        style="font-size: 48px; margin-bottom: 16px; display: block;"></i>
                                    No pending parts requests found.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Request History Tab -->
                    <div id="request-history" class="tab-content">
                        <div class="card">
                            <div class="card-header">
                                <h4>Parts Request History</h4>
                                <p>View all your previous parts requests</p>
                            </div>
                            <div class="card-content">
                                <p style="text-align: center; color: #64748b; padding: 40px;">
                                    <i class="fas fa-history"
                                        style="font-size: 48px; margin-bottom: 16px; display: block;"></i>
                                    No request history available.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Delivery Challan Section -->
                <div id="delivery-challan" class="section">
                    <div class="section-header">
                        <div>
                            <h3>Delivery Challan</h3>
                            <p>Generate delivery challan for service jobs</p>
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="card-header">
                            <h4><i class="fas fa-file-invoice"></i> Generate Delivery Challan</h4>
                            <p>Create a delivery document with job details, engineer assignment, and goods information
                            </p>
                        </div>
                        <div class="card-content">
                            <form id="deliveryChallanForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <h5 style="margin-bottom: 16px; color: #374151;">Job Information</h5>
                                        <label for="challanComplaintNumber">Complaint Number*</label>
                                        <input type="text" id="challanComplaintNumber" name="complaintNumber"
                                            placeholder="Enter complaint number" required>
                                        <div class="error-message" id="challanComplaintNumberError"></div>
                                    </div>
                                    <div class="form-group">
                                        <h5 style="margin-bottom: 16px; color: #374151;">Charges & Goods</h5>
                                        <label for="serviceCharges">Service Charges*</label>
                                        <input type="number" id="serviceCharges" name="serviceCharges"
                                            placeholder="Enter service charges" min="0" step="0.01" required>
                                        <div class="error-message" id="serviceChargesError"></div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="assignedEngineer">Assigned Engineer*</label>
                                        <select id="assignedEngineer" name="assignedEngineer" required>
                                            <option value="">-- Select Engineer --</option>
                                            <option value="Amit Kumar">Amit Kumar</option>
                                            <option value="Rajesh Singh">Rajesh Singh</option>
                                            <option value="Priya Sharma">Priya Sharma</option>
                                            <option value="Vikash Gupta">Vikash Gupta</option>
                                        </select>
                                        <div class="error-message" id="assignedEngineerError"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="quantityRequired">Quantity Required*</label>
                                        <input type="number" id="quantityRequired" name="quantityRequired"
                                            placeholder="Enter quantity" min="1" required>
                                        <div class="error-message" id="quantityRequiredError"></div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="goodsDescription">Description of Goods*</label>
                                    <textarea id="goodsDescription" name="goodsDescription" rows="4"
                                        placeholder="Describe the goods/parts required to solve the problem..."
                                        required></textarea>
                                    <div class="error-message" id="goodsDescriptionError"></div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-download"></i> Generate Challan Document
                                    </button>
                                    <button type="button" class="btn btn-outline" id="saveChallanDraftBtn">
                                        <i class="fas fa-save"></i> Save as Draft
                                    </button>
                                    <button type="button" class="btn btn-outline" id="resetChallanBtn">
                                        <i class="fas fa-undo"></i> Reset
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Recent Challans -->
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-history"></i> Recent Delivery Challans</h4>
                            <p>View recently generated delivery challans</p>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table class="jobs-table">
                                    <thead>
                                        <tr>
                                            <th>Challan ID</th>
                                            <th>Complaint Number</th>
                                            <th>Engineer</th>
                                            <th>Service Charges</th>
                                            <th>Quantity</th>
                                            <th>Status</th>
                                            <th>Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="job-id">#CH001</span></td>
                                            <td><span class="job-id">#CMP12345</span></td>
                                            <td>Amit Kumar</td>
                                            <td>₹1,500</td>
                                            <td>2</td>
                                            <td><span class="badge badge-success">Generated</span></td>
                                            <td>
                                                <div class="date-cell">
                                                    <i class="fas fa-calendar"></i>
                                                    2024-01-15
                                                </div>
                                            </td>
                                            <td>
                                                <div class="action-buttons">
                                                    <button class="action-btn">
                                                        <i class="fas fa-download"></i>
                                                    </button>
                                                    <button class="action-btn">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Settings Sections (Placeholder) -->
                <div id="preferences" class="section">
                    <div class="section-header">
                        <h3>Preferences</h3>
                        <p>Manage your application preferences and settings</p>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <p style="text-align: center; color: #64748b; padding: 40px;">
                                <i class="fas fa-cog" style="font-size: 48px; margin-bottom: 16px; display: block;"></i>
                                Preferences settings will be implemented here.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- User Management Section -->
                <div id="user-management" class="section">
                    <div class="section-header">
                        <h3>User Management</h3>
                        <p>Manage user accounts and permissions</p>
                    </div>

                    <!-- Centering wrapper -->
                    <div class="form-center-wrapper">
                        <div class="card">
                            <div class="card-header" style="text-align: center;">
                                <h4 style="margin: 0;">Change Password</h4>
                            </div>

                            <div class="card-content">
                                <form id="passwordChangeForm" onsubmit="return false;">
                                    <div class="form-group">
                                        <label for="username">Username</label>
                                        <input type="text" id="username" class="form-input" required />
                                    </div>

                                    <div class="form-group password-group">
                                        <label for="oldPassword">Old Password</label>
                                        <input type="password" id="oldPassword" class="form-input" required />
                                        <span class="toggle-icon" onclick="togglePassword('oldPassword', this)">
                                            <i class="fas fa-eye"></i>
                                        </span>
                                    </div>

                                    <div class="form-group password-group">
                                        <label for="newPassword">New Password</label>
                                        <input type="password" id="newPassword" class="form-input" required />
                                        <span class="toggle-icon" onclick="togglePassword('newPassword', this)">
                                            <i class="fas fa-eye"></i>
                                        </span>
                                        <small id="passwordSameError" class="error-message">❌ New password must be
                                            different from old password.</small>

                                    </div>

                                    <div class="form-group password-group">
                                        <label for="confirmPassword">Confirm New Password</label>
                                        <input type="password" id="confirmPassword" class="form-input" required />
                                        <span class="toggle-icon" onclick="togglePassword('confirmPassword', this)">
                                            <i class="fas fa-eye"></i>
                                        </span>
                                        <small id="passwordError" class="error-message">❌ Passwords do not
                                            match.</small>
                                        <small id="passwordSuccess" class="success-message">✅ Passwords match.</small>
                                    </div>

                                    <button type="submit" class="submit-button" onclick="submitPasswordChange()">Change
                                        Password</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>


            </main>
        </div>
    </div>
    <!-- Modern Confirmation Modal -->
    <div id="confirmModal" class="modern-modal">
        <div class="modern-modal-content">
            <div class="modal-icon warning">
                <i class="fas fa-exclamation-circle"></i>
            </div>
            <h2>Unsaved Changes</h2>
            <p>You've made changes that haven't been saved. Are you sure you want to refresh?</p>
            <div class="modal-actions">
                <button id="confirmYes" class="btn btn-danger">Yes, Refresh</button>
                <button id="confirmNo" class="btn btn-neutral">No, Keep Editing</button>
            </div>
        </div>
    </div>

    <!-- Complaint Detail Modal -->
    <div class="modal-overlay" id="complaintDetailModal" style="display: none;">
        <div class="modal-content" style="max-width: 900px; width: 90%;">
            <div class="modal-header">
                <h3>Complaint Details</h3>
                <button class="modal-close" onclick="closeComplaintDetail()">&times;</button>
            </div>
            <div class="modal-body" id="complaintDetailContent">
                <!-- Content will be populated dynamically -->
            </div>
        </div>
    </div>


    <!-- Mobile Navigation Toggle -->
    <script src="../js/Config.js"></script>
    <script src="../js/call_registration.js"></script>
    <script src="../js/service_center.js"></script>
    <script src="../js/complaint.js"></script>
    <script src="../js/dashboard.js"></script>

</body>

</html>